<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predict Bench Annotation Tool</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <h1>Spatial Benchmark Annotation Tool</h1>
        <nav>
            <a href="/" class="active">Annotate</a>
            <a href="/view">View Annotations</a>
        </nav>
    </header>

    <main>
        <section id="video-input-section">
            <h2>Step 1: Enter YouTube URL or Load Local Video</h2>
            <div class="input-group">
                <input type="text" id="youtube-url" placeholder="Paste YouTube URL here...">
                <button id="download-btn" class="primary-btn">
                    <i class="fas fa-download"></i> Download Video
                </button>
                <!-- 隐藏的文件选择器 -->
                <input type="file" id="local-video-file" accept="video/*" style="display: none;">
                <button id="load-local-btn" class="primary-btn">
                    <i class="fas fa-upload"></i> Load Local Video
                </button>
            </div>
            <div id="download-status" class="status-message"></div>
            <div id="upload-status" class="status-message"></div>
        </section>


        <section id="video-player-section" class="hidden">
            <h2 id="video-title">Step 2: Video Playback</h2>
            <div class="video-container">
                <video id="video-player" controls></video>
                
                <div id="timeline-container">
                    <div id="timeline">
                        <div id="progress-bar"></div>
                        <div id="shot-markers"></div>
                        <div id="selection-start" class="timeline-marker" title="Selection Start"></div>
                        <div id="selection-cutpoint" class="timeline-marker-cutpoint" title="Selection Cutpoint"></div>
                        <div id="selection-end" class="timeline-marker" title="Selection End"></div>
                    </div>
                    
                    <div id="timeline-controls">
                        <button id="play-pause-btn" class="control-btn">
                            <i class="fas fa-play"></i>
                        </button>
                        <span id="current-time">0:00</span> / <span id="duration">0:00</span>
                        
                        <button id="set-start-btn" class="control-btn">
                            <i class="fas fa-flag-checkered"></i> Set Start
                        </button>
                        <button id="set-cutpoint-btn" class="control-btn">
                            <i class="fas fa-map-marker-alt"></i> Set Cut Point
                        </button>
                        <button id="set-end-btn" class="control-btn">
                            <i class="fas fa-flag"></i> Set End
                        </button>
                        <button id="preview-selection-btn" class="control-btn">
                            <i class="fas fa-eye"></i> Preview Selection
                        </button>
                        <button id="play-start-to-cutpoint-btn" class="control-btn">
                            <i class="fas fa-play"></i> Play Start → Cut
                        </button>
                        <button id="play-cutpoint-to-end-btn" class="control-btn">
                            <i class="fas fa-play"></i> Play Cut → End
                        </button>
                        <button id="detect-shots-btn" class="control-btn">
                            <i class="fas fa-film"></i> Detect Shots
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="annotation-section" class="hidden">
            <h2>Step 3: Create Question & Answers</h2>
            <div class="annotation-container">
                <div class="form-group">
                    <label for="question-text">Question:</label>
                    <textarea id="question-text" placeholder="Enter your question based on the selected video segment..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="question-type">Question Type:</label>
                        <select id="question-type">
                            <option value="" disabled selected>Select an type</option>
                            <option value="counting">Counting</option>
                            <option value="relation">Relation</option>
                            <option value="relativeDistance">Relative Distance</option>
                            <option value="appearanceOrder">Appearance Order</option>
                            <option value="routePlan">Route Plan</option>
                            <option value="location">Location</option>
                            <option value="relativeSize">Relative Size</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="predict-direction">Predict Direction:</label>
                        <select id="predict-direction">
                            <option value="" disabled selected>Select an Direction</option>
                            <option value="future">Future</option>
                            <option value="past">Past</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" id="answers-container">
                    <label>Answer Choices:</label>
                    <div class="answer-options">
                        <div class="answer-option">
                            <input type="radio" name="correct-answer" id="correct-0" value="0">
                            <input type="text" id="answer-0" placeholder="Answer choice 1">
                            <button class="remove-answer-btn" data-id="0">✕</button>
                        </div>
                        <div class="answer-option">
                            <input type="radio" name="correct-answer" id="correct-1" value="1">
                            <input type="text" id="answer-1" placeholder="Answer choice 2">
                            <button class="remove-answer-btn" data-id="1">✕</button>
                        </div>
                    </div>
                    <button id="add-answer-btn" class="secondary-btn">
                        <i class="fas fa-plus"></i> Add Answer Choice
                    </button>
                </div>
                
                <div class="form-actions">
                    <button id="save-annotation-btn" class="primary-btn">
                        <i class="fas fa-save"></i> Save Annotation
                    </button>
                    <div id="save-status" class="status-message"></div>
                </div>
            </div>
        </section>

        <section id="saved-annotations-section" class="hidden">
            <h2>Saved Annotations</h2>
            <div id="annotations-list"></div>
        </section>
    </main>

    <footer>
        <p>Spatial Benchmark Annotation Tool &copy; 2025</p>
    </footer>

    <script src="/static/js/app.js"></script>
</body>
</html>
